<?xml version="1.0" encoding="UTF-8"?>
<Patch>
    <Operation Class="XmlExtensions.OptionalPatch">
        <modId>Biocoder</modId>
        <key>enable_weapon_biocode</key>
        <defaultValue>false</defaultValue>
        <caseTrue>
            <Operation Class="PatchOperationRemove">
                <xpath>Defs/ThingDef[weaponTags or weaponClasses]/comps/li[@Class="CompProperties_Biocodable"]</xpath>
            </Operation>
            <Operation Class="XmlExtensions.PatchOperationSafeAdd">
                <xpath>Defs/ThingDef[@ParentName="BaseWeapon"]</xpath>
                <value>
                    <comps/>
                </value>
            </Operation>
            <Operation Class="XmlExtensions.PatchOperationAdd">
                <!-- do not override Bladelink behavior -->
                <xpath>Defs/ThingDef[@ParentName="BaseWeapon" and not (@Name="BaseWeapon_Bladelink")]/comps</xpath>
                <value>
                    <li Class="CompProperties_Biocodable" />
                </value>
            </Operation>
        </caseTrue>
    </Operation>
    <Operation Class="XmlExtensions.OptionalPatch">
        <modId>Biocoder</modId>
        <key>enable_apparel_biocode</key>
        <defaultValue>false</defaultValue>
        <caseTrue>
            <Operation Class="PatchOperationRemove">
                <xpath>Defs/ThingDef[apparel]/comps/li[@Class="CompProperties_Biocodable"]</xpath>
            </Operation>
            <Operation Class="PatchOperationAdd">
                <xpath>Defs/ThingDef[@Name="ApparelBase"]/comps</xpath>
                <value>
                    <li Class="CompProperties_Biocodable" />
                </value>
            </Operation>
        </caseTrue>
    </Operation>
</Patch>